---
title: "520A_project"
author: "Zhipeng Zhu"
date: "2/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggfortify)
library(lubridate)
```

```{r}
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
```

```{r}
vix = vix %>% 
  group_by(Date=floor_date(DATE, "month")) %>%
  summarize(VIX=mean(CLOSE)) %>%
  filter(Date < "2018-05-01")
head(vix, 10)
```

```{r}
data = data %>% filter(Date > "1989-12-01")
head(data, 10)
```

```{r}
data = inner_join(data, vix)
```


```{r}
p_sp500 = data %>% 
  ggplot(aes(x = Date, y = SP500)) +
  geom_point(size = 1)
p_cpi = data %>% 
  ggplot(aes(x = Date, y = Consumer.Price.Index)) +
  geom_line(color = "red")
p_lir = data %>% 
  ggplot(aes(x = Date, y = Long.Interest.Rate)) +
  geom_line(color = "red")
p_pe10 = data %>% 
  ggplot(aes(x = Date, y = PE10)) +
  geom_line(color = "blue")
p_div = data %>% 
  ggplot(aes(x = Date, y = Dividend)) +
  geom_line(color = "blue")
p_earn = data %>% 
  ggplot(aes(x = Date, y = Earnings)) +
  geom_line(color = "blue")
p_vix = data %>% 
  ggplot(aes(x = Date, y = VIX)) +
  geom_line(color = "red")
```

```{r}
p_sp500
```

```{r}
p_vix
```

```{r}
p_lir
```

```{r}
p_cpi
```

```{r}
p_pe10
```

```{r}
p_div
```

```{r}
p_earn
```


```{r}
data %>% 
  ggplot(aes(x = Date, y = SP500)) +
  geom_point() +
  geom_line(aes(x = Date, y = Real.Price), color = "red")
```