geom_line(color = "brown")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "green")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "yellow")
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1) +
geom_vline(2000)
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = Consumer.Price.Index)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = Long.Interest.Rate)) +
geom_line(color = "blue")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "brown")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "green")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "yellow")
p_sp500
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix
data
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE)
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
#vix$DATE = as.Date(vix$DATE)
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix
vix %>% group_by(month=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE))
vix %>%
group_by(month=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE)) %>%
filter(month < "2018-05-01")
data %>% filter(Date > "1989-12-01")
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = Consumer.Price.Index)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = Long.Interest.Rate)) +
geom_line(color = "blue")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "brown")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "green")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "yellow")
p_sp500
p_cpi
p_pe10
p_lir
p_div
p_earn
data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point() +
geom_line(aes(x = Date, y = Real.Price), color = "red")
vix = vix %>%
group_by(month=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE)) %>%
filter(month < "2018-05-01")
vix = vix %>%
group_by(month=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE)) %>%
filter(month < "2018-05-01")
vix = vix %>%
group_by(month=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE)) %>%
filter(month < "2018-05-01")
vix = vix %>%
group_by(month=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE)) %>%
filter(month < "2018-05-01")
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix = vix %>%
group_by(month=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE)) %>%
filter(month < "2018-05-01")
head(vix, 10)
data = data %>% filter(Date > "1989-12-01")
head(data, 10)
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix = vix %>%
group_by(Date=floor_date(DATE, "month")) %>%
summarize(vix_avg=mean(CLOSE)) %>%
filter(Date < "2018-05-01")
head(vix, 10)
vix = vix %>%
group_by(Date=floor_date(DATE, "month")) %>%
summarize(VIX=mean(CLOSE)) %>%
filter(Date < "2018-05-01")
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix = vix %>%
group_by(Date=floor_date(DATE, "month")) %>%
summarize(VIX=mean(CLOSE)) %>%
filter(Date < "2018-05-01")
head(vix, 10)
data = data %>% filter(Date > "1989-12-01")
head(data, 10)
inner_join(data, vix, by = Date)
inner_join(data, vix)
data = inner_join(data, vix)
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = Consumer.Price.Index)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = Long.Interest.Rate)) +
geom_line(color = "blue")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "brown")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "green")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "yellow")
p_sp500
p_cpi
p_pe10
p_lir
p_div
p_lir
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = Consumer.Price.Index)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = Long.Interest.Rate)) +
geom_line(color = "red")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "blue")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "blue")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "blue")
p_earn = data %>%
ggplot(aes(x = Date, y = VIX)) +
geom_line(color = "red")
p_sp500
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = Consumer.Price.Index)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = Long.Interest.Rate)) +
geom_line(color = "red")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "blue")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "blue")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "blue")
p_vix = data %>%
ggplot(aes(x = Date, y = VIX)) +
geom_line(color = "red")
p_vix
p_vix
p_earn
data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point() +
geom_line(aes(x = Date, y = Real.Price), color = "red")
install.packages("bsts")
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point() +
geom_line(aes(x = Date, y = Real.Price), color = "red")
ss <- AddLocalLinearTrend(list(), data$SP500)
ss <- AddSeasonal(ss, data$SP500, nseasons = 52)
model <- bsts(SP500 ~ ., state.specification = ss, data =
data, niter = 1000)
data
data %>% summarise(is.na())
sum(is.na(data))
summary(is.na(data))
data = inner_join(data, vix)
summary(is.na(data))
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate) %>%
select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate) %>%
select(c(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings))
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
data
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
data = data %>% filter(!is.na(PE10), Date > 1971-12-31)
vix = vix %>%
group_by(Date=floor_date(DATE, "month")) %>%
summarize(VIX=mean(CLOSE)) %>%
filter(Date < "2018-05-01")
head(vix, 10)
data = data %>% filter(Date > "1989-12-01")
head(data, 10)
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
data %>% select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
data %>% tidyverse::select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
data %>% dplyr::select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
summary(is.na(data))
data = data %>% dplyr::select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
summary(is.na(data))
install.packages("MICE")
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
library(MICE)
install.packages("mice")
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
library(mice)
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
library(mice)
md.pattern(data)
tempData <- mice(data,m=5,maxit=50,meth='pmm',seed=500)
summary(tempData)
tempData
completedData <- complete(tempData,1)
completedData
summary(is.na(completedData))
data <- complete(tempData,1)
summary(is.na(data))
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = Consumer.Price.Index)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = Long.Interest.Rate)) +
geom_line(color = "red")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "blue")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "blue")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "blue")
p_vix = data %>%
ggplot(aes(x = Date, y = VIX)) +
geom_line(color = "red")
p_sp500
p_vix
p_lir
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = CPI)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = LIR)) +
geom_line(color = "red")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "blue")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "blue")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "blue")
p_vix = data %>%
ggplot(aes(x = Date, y = VIX)) +
geom_line(color = "red")
p_sp500
p_vix
p_lir
p_cpi
p_pe10
p_div
p_earn
data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point() +
geom_line(aes(x = Date, y = Real.Price), color = "red")
ss <- AddLocalLinearTrend(list(), data$SP500)
ss <- AddSeasonal(ss, data$SP500, nseasons = 52)
model <- bsts(SP500 ~ ., state.specification = ss, data =
data, niter = 1000)
ss <- AddLocalLinearTrend(list(), data$SP500)
ss <- AddSeasonal(ss, data$SP500, nseasons = 12)
model <- bsts(SP500 ~ ., state.specification = ss, data =
data, niter = 1000)
plot(model)
ss <- AddLocalLinearTrend(list(), data$LIR)
ss <- AddSeasonal(ss, data$LIR, nseasons = 12)
model <- bsts(LIR ~ ., state.specification = ss, data =
data, niter = 1000)
plot(model)
summary(model)
ss <- AddLocalLinearTrend(list(), data$SP500)
ss <- AddSeasonal(ss, data$SP500, nseasons = 12)
model <- bsts(SP500 ~ ., state.specification = ss, data =
data, niter = 1000)
plot(model)
summary(model)
data_ts = xts(data, data$Date)
data_ts
data
data_ts = xts(data$LIR, data$Date)
data_ts
data_ts = xts(data[-1], data$Date)
data_ts
ss <- AddLocalLinearTrend(list(), data_ts$SP500)
ss <- AddSeasonal(ss, data_ts$SP500, nseasons = 12)
model <- bsts(SP500 ~ ., state.specification = ss, data =
data_ts, niter = 1000)
plot(model)
summary(model)
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
library(mice)
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
vix = vix %>%
group_by(Date=floor_date(DATE, "month")) %>%
summarize(VIX=mean(CLOSE)) %>%
filter(Date < "2018-05-01")
head(vix, 10)
data = data %>% filter(Date > "1989-12-01")
head(data, 10)
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
data = data %>% dplyr::select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
md.pattern(data)
tempData <- mice(data,m=5,maxit=50,meth='pmm',seed=500)
tempData = mice(data,m=5,maxit=50,meth='pmm',seed=500)
tempData = mice(data,m=5,maxit=50,meth='pmm',seed=500)
tempData = mice(data,m=5,maxit=50,meth='pmm',seed=500)
data = complete(tempData,1)
summary(is.na(data))
p_sp500 = data %>%
ggplot(aes(x = Date, y = SP500)) +
geom_point(size = 1)
p_cpi = data %>%
ggplot(aes(x = Date, y = CPI)) +
geom_line(color = "red")
p_lir = data %>%
ggplot(aes(x = Date, y = LIR)) +
geom_line(color = "red")
p_pe10 = data %>%
ggplot(aes(x = Date, y = PE10)) +
geom_line(color = "blue")
p_div = data %>%
ggplot(aes(x = Date, y = Dividend)) +
geom_line(color = "blue")
p_earn = data %>%
ggplot(aes(x = Date, y = Earnings)) +
geom_line(color = "blue")
p_vix = data %>%
ggplot(aes(x = Date, y = VIX)) +
geom_line(color = "red")
data_ts = xts(data[-1], data$Date)
ss = AddLocalLinearTrend(list(), data_ts$SP500)
ss = AddSeasonal(ss, data_ts$SP500, nseasons = 12)
model = bsts(SP500 ~ ., state.specification = ss, data =
data_ts, niter = 1000)
ss = AddLocalLinearTrend(list(), data_ts$SP500)
ss = AddSeasonal(ss, data_ts$SP500, nseasons = 12)
model = bsts(SP500 ~ ., state.specification = ss, data =
data_ts, niter = 1000)
summary(model)
autoplot(model)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
library(mice)
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
vix = vix %>%
group_by(Date=floor_date(DATE, "month")) %>%
summarize(VIX=mean(CLOSE)) %>%
filter(Date < "2018-05-01")
head(vix, 10)
data = data %>% filter(Date > "1989-12-01")
head(data, 10)
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
data = data %>% dplyr::select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
md.pattern(data)
summary(is.na(data))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggfortify)
library(lubridate)
library(bsts)
library(mice)
data = read.csv("../data/sp500.csv")
vix = read.csv("../data/VIX_History.csv")
data$Date = as.Date(data$Date)
vix$DATE = as.Date(vix$DATE, format = "%m/%d/%Y")
vix = vix %>%
group_by(Date=floor_date(DATE, "month")) %>%
summarize(VIX=mean(CLOSE)) %>%
filter(Date < "2018-05-01")
head(vix, 10)
data = data %>% filter(Date > "1989-12-01")
head(data, 10)
data = inner_join(data, vix) %>%
rename(CPI = Consumer.Price.Index,
LIR = Long.Interest.Rate)
data = data %>% dplyr::select(Date, SP500, CPI, LIR, PE10, VIX, Dividend, Earnings)
md.pattern(data)
tempData = mice(data,m=5,maxit=50,meth='pmm',seed=500)
data = complete(tempData,1)
summary(is.na(data))
